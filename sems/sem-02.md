# Compile. Makefile.

## Compile

Процессы.

Минимальная единица исполнения, в которой запускается программы. Процессы могут общаться друг с другом. Основные утилиты для работы: top, htop, kill, ps.

Компилятор — транслятор, который осуществляет перевод всей исходной программы в эквивалентную ей результирующую программу на языке машинных команд или на языке ассемблера. Для C++ 3 наиболее популярных компилятора: gcc, clang, msvc, mingw. Последние 2 Windows-only. Подробнее про работу компилятора и различия в работе поговорим позже. Сейчас важно понимать общие этапы работы.

2 популярных семейства UNIX-like систем: Linux(GNU/Linux) и BSD. В Linux обычно установлен gcc по умолчанию, в BSD clang. Существуют также символические ссылки вида g++ и gcc.

1. Препроцессинг (g++ -E)
2. Компиляция (g++ -c) -S для вызова ассемблера
3. Компоновка (ld)

Оптимизации. -O0/1/2/3
Опция -D задать переменную для сборки.

Санитайзеры: -fsanitize=address/memory/undefined

Для языков семейства Си нет единого стандарта, как должен быть отформатирован код. Есть несколько сложившихся в Open Source стандартов, которые задаются опцией --style=ИМЯ: LLVM, GNU, Google, Chromium, Microsoft, Mozilla, WebKit. Если указать опцию --style=file, то стандарт оформления будет использован из локального файла .clang-format (имя начинается с символа точки). Файл .clang-format может располагаться не только в одном каталоге с исходным файлом, но и в любом каталоге выше по иерархии, - в этом случае будет использован первый найденный файл.

По умолчанию утилита clang-format выводит преобразованный исходный файл на стандартный поток вывода, опция -i (inplace) указывает, что необходимо перезаписать исходный файл.

# Makefile

Пример разобранного Makefile можно взглянуть [здесь](/sems/sem-02/project/Makefile). Разберем основные вещи:
* Makefile - bash-like скрипт для сборки.
* Ключевое понятие - таргет сборки.
* Таргет состоит из зависимостей и команды. Например, взглянем на таргет:
```Makefile
all: library main
	$(LINK) -o alert library.so main.o
```

Здесь мы говорим, что сначала должны быть собраны таргеты library и main, а затем мы статически линкуем 2 таргета.

Пробелы и отступы **важны** при задании Makefile. Полезная опция: `make -j16 all` - собрать таргет all используя 16 ядер процессора.